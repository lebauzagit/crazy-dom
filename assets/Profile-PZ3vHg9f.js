import{a as f,b as e,o as m,d as M,u as N,c as E,r as p,p as F,f as _,m as k,k as w,v as g,j as d,t as h,q as B,h as P,g as S}from"./index-BEdaMpnO.js";import{r as j}from"./UserCircleIcon-CclUEI9D.js";import{r as z}from"./ExclamationTriangleIcon-BlEb5Ssm.js";import{r as D}from"./CheckCircleIcon-Bgu_D803.js";function G(U,i){return m(),f("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6.827 6.175A2.31 2.31 0 0 1 5.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 0 0-1.134-.175 2.31 2.31 0 0 1-1.64-1.055l-.822-1.316a2.192 2.192 0 0 0-1.736-1.039 48.774 48.774 0 0 0-5.232 0 2.192 2.192 0 0 0-1.736 1.039l-.821 1.316Z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.5 12.75a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0ZM18.75 10.5h.008v.008h-.008V10.5Z"})])}const Z={class:"space-y-6"},$={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},I={class:"bg-white shadow-sm rounded-lg"},T={class:"px-6 py-8"},q=["value"],J=["disabled"],H={class:"bg-white shadow-sm rounded-lg"},K={class:"px-6 py-8"},L=["disabled"],O={class:"bg-white shadow-sm rounded-lg"},Q={class:"px-6 py-8"},R={class:"flex items-center space-x-6"},W={class:"flex-shrink-0"},X=["src"],Y={class:"flex-1"},ee={for:"avatar",class:"cursor-pointer"},se={class:"btn btn-outline"},te={key:0,class:"bg-red-50 border border-red-200 rounded-md p-4"},ae={class:"flex"},oe={class:"ml-3"},le={class:"mt-1 text-sm text-red-700"},re={key:1,class:"bg-green-50 border border-green-200 rounded-md p-4"},ne={class:"flex"},de={class:"ml-3"},ie={class:"mt-1 text-sm text-green-700"},fe=M({__name:"Profile",setup(U){const i=N(),x=E(()=>i.user),{loading:v}=i,y=p(null),a=p(""),r=p(""),n=p({full_name:"",phone:""}),l=p({newPassword:"",confirmPassword:""}),b=async()=>{if(x.value)try{const t=await i.getProfile(x.value.id);t&&(y.value=t,n.value.full_name=t.full_name||"",n.value.phone=t.phone||"")}catch(t){console.error("Error loading profile:",t)}},V=async()=>{a.value="",r.value="";try{await i.updateProfile({full_name:n.value.full_name,phone:n.value.phone}),r.value="Profile updated successfully!",await b()}catch(t){a.value=t.message||"Failed to update profile"}},A=async()=>{if(a.value="",r.value="",l.value.newPassword!==l.value.confirmPassword){a.value="Passwords do not match";return}if(l.value.newPassword.length<6){a.value="Password must be at least 6 characters long";return}try{await i.resetPassword(l.value.newPassword),r.value="Password updated successfully!",l.value.newPassword="",l.value.confirmPassword=""}catch(t){a.value=t.message||"Failed to update password"}},C=async t=>{var c;const u=(c=t.target.files)==null?void 0:c[0];if(u){if(u.size>2*1024*1024){a.value="File size must be less than 2MB";return}a.value="",r.value="";try{const o=await i.uploadAvatar(u);console.log("Avatar uploaded to:",o),r.value="Avatar uploaded successfully!",await b()}catch(o){a.value=o.message||"Failed to upload avatar"}}};return F(()=>{b()}),(t,s)=>{var u,c;return m(),f("div",Z,[s[16]||(s[16]=e("div",{class:"bg-white shadow-sm rounded-lg"},[e("div",{class:"px-6 py-8"},[e("h1",{class:"text-2xl font-bold text-gray-900"},"Profile Settings"),e("p",{class:"mt-2 text-sm text-gray-600"}," Update your profile information and manage your account settings. ")])],-1)),e("div",$,[e("div",I,[e("div",T,[s[7]||(s[7]=e("h2",{class:"text-lg font-medium text-gray-900 mb-6"}," Profile Information ",-1)),e("form",{onSubmit:k(V,["prevent"]),class:"space-y-4"},[e("div",null,[s[4]||(s[4]=e("label",{for:"full_name",class:"block text-sm font-medium text-gray-700"}," Full Name ",-1)),w(e("input",{id:"full_name","onUpdate:modelValue":s[0]||(s[0]=o=>n.value.full_name=o),type:"text",class:"mt-1 input",placeholder:"Enter your full name"},null,512),[[g,n.value.full_name]])]),e("div",null,[s[5]||(s[5]=e("label",{for:"email",class:"block text-sm font-medium text-gray-700"}," Email Address ",-1)),e("input",{id:"email",value:(u=x.value)==null?void 0:u.email,type:"email",disabled:"",class:"mt-1 input bg-gray-50 text-gray-500 cursor-not-allowed",placeholder:"Email cannot be changed"},null,8,q)]),e("div",null,[s[6]||(s[6]=e("label",{for:"phone",class:"block text-sm font-medium text-gray-700"}," Phone Number ",-1)),w(e("input",{id:"phone","onUpdate:modelValue":s[1]||(s[1]=o=>n.value.phone=o),type:"tel",class:"mt-1 input",placeholder:"Enter your phone number"},null,512),[[g,n.value.phone]])]),e("button",{type:"submit",disabled:d(v),class:"btn btn-primary w-full py-2"},h(d(v)?"Updating...":"Update Profile"),9,J)],32)])]),e("div",H,[e("div",K,[s[10]||(s[10]=e("h2",{class:"text-lg font-medium text-gray-900 mb-6"}," Change Password ",-1)),e("form",{onSubmit:k(A,["prevent"]),class:"space-y-4"},[e("div",null,[s[8]||(s[8]=e("label",{for:"newPassword",class:"block text-sm font-medium text-gray-700"}," New Password ",-1)),w(e("input",{id:"newPassword","onUpdate:modelValue":s[2]||(s[2]=o=>l.value.newPassword=o),type:"password",class:"mt-1 input",placeholder:"Enter new password"},null,512),[[g,l.value.newPassword]])]),e("div",null,[s[9]||(s[9]=e("label",{for:"confirmPassword",class:"block text-sm font-medium text-gray-700"}," Confirm New Password ",-1)),w(e("input",{id:"confirmPassword","onUpdate:modelValue":s[3]||(s[3]=o=>l.value.confirmPassword=o),type:"password",class:"mt-1 input",placeholder:"Confirm new password"},null,512),[[g,l.value.confirmPassword]])]),e("button",{type:"submit",disabled:d(v),class:"btn btn-secondary w-full py-2"},h(d(v)?"Updating...":"Update Password"),9,L)],32)])])]),e("div",O,[e("div",Q,[s[13]||(s[13]=e("h2",{class:"text-lg font-medium text-gray-900 mb-6"},"Profile Avatar",-1)),e("div",R,[e("div",W,[(c=y.value)!=null&&c.avatar_url?(m(),f("img",{key:0,src:y.value.avatar_url,alt:"Profile",class:"h-20 w-20 rounded-full object-cover"},null,8,X)):(m(),B(d(j),{key:1,class:"h-20 w-20 text-gray-400"}))]),e("div",Y,[e("label",ee,[e("span",se,[P(d(G),{class:"w-4 h-4 mr-2"}),s[11]||(s[11]=S(" Change Avatar "))]),e("input",{id:"avatar",type:"file",accept:"image/*",class:"hidden",onChange:C},null,32)]),s[12]||(s[12]=e("p",{class:"mt-2 text-sm text-gray-500"}," JPG, PNG or GIF. Max file size 2MB. ",-1))])])])]),a.value?(m(),f("div",te,[e("div",ae,[P(d(z),{class:"h-5 w-5 text-red-400"}),e("div",oe,[s[14]||(s[14]=e("h3",{class:"text-sm font-medium text-red-800"},"Error",-1)),e("p",le,h(a.value),1)])])])):_("",!0),r.value?(m(),f("div",re,[e("div",ne,[P(d(D),{class:"h-5 w-5 text-green-400"}),e("div",de,[s[15]||(s[15]=e("h3",{class:"text-sm font-medium text-green-800"},"Success",-1)),e("p",ie,h(r.value),1)])])])):_("",!0)])}}});export{fe as default};
